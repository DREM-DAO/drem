Base cloned from http://github.com/scholtz/wallet